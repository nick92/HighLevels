<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<title>Insert title here</title>
</head>
<body>
<div id="demo"></div>
<form name="log_in" action="functions.php" method="post">
Username: <input type="text" name="user">
Password: <input type="password" name="pass">
<input type="submit" value="Submit">
</form> 
<form name="register" action="functions.php" method="post">
Username: <input type="text" name="user">
Password: <input type="password" name="pass">
<input type="text" name="location" value="" id="loc">
<input type="submit" value="Submit">
</form> 
<script>
	
var x = document.getElementById("demo");

if ("geolocation" in navigator) {
	navigator.geolocation.getCurrentPosition(function(position) {
		//do_something(position.coords.latitude, position.coords.longitude);
		var longi = position.coords.longitude;
		var lat = position.coords.latitude;
		var location;
		$.get("http://maps.googleapis.com/maps/api/geocode/json?latlng=" + lat + "," + longi +"&sensor=false", function(data)
		{
			x.innerHTML = data.results[0].address_components[2].long_name;
			location = data.results[0].address_components[2].long_name;
			document.getElementById('loc').value = location; 
		});
		
		$.get("weather/Rhyl.json", function(data)
		{
			
		}).fail(function()
		{
			// if file doesn't exist do curl request
			$.POST("getWeather.php", {data: 1, location: location}, function(data){alert(data)});
			
		});
	});
} else {
  		x.innerHTML = "Geolocation not found";
}
</script>
</body>
</html>
